/*
*Designed by Jonathan Nungaray
*@Jonatthu
*/

$(document).on('click', '.more', function(e) {
    e.preventDefault();
    var element = $(this);
    var block = element.parent().get(0).getAttribute('id');
	var tutor_id = element.parent().get(0).getAttribute('data-tutor-id');
	var selector = "#"+block;
	var subject = $(selector + " .head .subject").html();
    var content = element.html();
    var url = window.location.pathname + "?vm_page=2&vm_subject=" + subject + "&vm_tutor=" + tutor_id;

    if (content == '<i class="fa fa-refresh"></i> Mostrar mas') {
        element.html('<i class="fa fa-refresh"></i> Mostrar menos');
			$.post( url, function( data ) {
				$( selector ).append( data );
			});
    } else {
        element.html('<i class="fa fa-refresh"></i> Mostrar mas');
        $(selector+" .video").slice(6, 12).remove();
    }

});

$(document).on('click', '.remove', function(e) {
    e.preventDefault();
    var element = $(this);
    var vm_id = element.attr('id');
    var content = element.html();
    var available;

    if (content == '<i class="fa fa-pencil-square-o"></i> Deshabilitar') {
        element.html('<i class="fa fa-pencil-square-o"></i> Habilitar');
        available = false;
    } else {
        element.html('<i class="fa fa-pencil-square-o"></i> Deshabilitar');
        available = true;
    }
	//alert(available+vm_id+"\n"+element.html());
    //alert("Informaci√≥n  alerta tmemporal despues la quito :p \n\nVideo id: " + vm_id + "&able= " + available);

    $.post("/home?vm_id=" + vm_id + "&available=" + available);
    /*data = {'vm_id':vm_id,'available':available}
    $.ajax({
        url: '/home',
        type: 'GET',
        data: data,
        dataType: 'json',
        success: function(data,status){
            alert(data.name);
            alert("Data" + data +"status"+status);
        }
    });
	*/
});

$(document).on('click', '#tutor, #subject', function(e) {
	e.preventDefault();
	var classy = $(this).attr('id');
	$(".block").fadeOut();
	var choice = "."+classy;
	setTimeout(function(){
		$(choice).fadeIn();
		$(document).scrollTop(327);
	}, 500);
});

$(document).on('click', '.toggle', function () {
    "use strict";
    var content = $(this);
    var target = content.parent().parent().get(0).getAttribute('id');
    var targetspani = "#" + target + " .toggle i";
    var targetspan = "#" + target + " .toggle";
    var targetcontent = "#" + target + " .video" + ", #" + target + " .more";

    var condi = $(targetspan).html();

    if (condi == '<i class="fa fa-caret-square-o-up"></i> Ocultar Materia') {

        $(targetspan).html('<i class="fa fa-caret-square-o-up"></i> Mostrar Materia');
        $(targetspani).animate({
            borderSpacing: -180
        }, {
            step: function (now, fx) {
                $(this).css('transform', 'rotate(' + now + 'deg)');
            },
            duration: 'fast'
        }, 'linear');
		$(targetcontent).fadeOut();

	} else if (condi == '<i class="fa fa-caret-square-o-up" style="transform: rotate(0deg); border-spacing: 0px;"></i> Ocultar Materia') {
		       $(targetspan).html('<i class="fa fa-caret-square-o-up"></i> Mostrar Materia');
        $(targetspani).animate({
            borderSpacing: -180
        }, {
            step: function (now, fx) {
                $(this).css('transform', 'rotate(' + now + 'deg)');
            },
            duration: 'fast'
        }, 'linear');
		$(targetcontent).fadeOut();
    }
    else {

        $(targetspan).html('<i class="fa fa-caret-square-o-up"></i> Ocultar Materia');
        $(targetspani).animate({
            borderSpacing: 0
        }, {
            step: function (now, fx) {
                $(this).css('transform', 'rotate(' + now + 'deg)');
            },
            duration: 'fast'
        }, 'linear');
		$(targetcontent).fadeIn();
    }

});


$(document).on('click', '#gToggle', function () {
    var condii = $(this).html();

    if (condii == '<i class="fa fa-sort"></i> Ocultar todo'){//|| condii == '<i class="fa fa-sort" style="transform: rotate(0deg); border-spacing: 0px;"></i> Ocultar todo') {
        $('#gToggle').html('<i class="fa fa-sort"></i> Mostrar todo');        
        $('.toggle').html('<i class="fa fa-caret-square-o-down"></i> Mostrar materia');
        //$(".toogle").html('<i class="fa fa-caret-square-o-up"></i> Mostrar Materia');
       $(".block .toogle i").animate({
            borderSpacing: -180
        }, {
            step: function (now, fx) {
                $(this).css('transform', 'rotate(' + now + 'deg)');
            },
            duration: 'fast'
        }, 'linear');

        $(".block .video, .block .more").fadeOut();         
       
        
    } else if(condii == '<i class="fa fa-sort" style="transform: rotate(0deg); border-spacing: 0px;"></i> Ocultar todo'){
        $('#gToggle').html('<i class="fa fa-sort"></i> Mostrar todo');        
        $('.toggle').html('<i class="fa fa-caret-square-o-down"></i> Mostrar materia');
        $(".block .toogle i").animate({
            borderSpacing: -180
        }, {
            step: function (now, fx) {
                $(this).css('transform', 'rotate(' + now + 'deg)');
            },
            duration: 'fast'
        }, 'linear');
        $(".block .video, .block .more").fadeOut();
    } else {
        $('#gToggle').html('<i class="fa fa-sort"></i> Ocultar todo');
        $('.toggle').html('<i class="fa fa-caret-square-o-up"></i> Ocultar materia');
        $(".block .toogle i").animate({
            borderSpacing: 0
        }, {
            step: function (now, fx) {
                $(this).css('transform', 'rotate(' + now + 'deg)');
            },
            duration: 'fast'
        }, 'linear');
        $(".block .video, .block .more").fadeIn();
    }

    //$(".video, .more").fadeToggle();

});

$(function () {
    var nav_pro_offset_top = $('#menu').offset().top;
    var nav_pro = function () {
    var scroll_topp = $(window).scrollTop();

    if (scroll_topp > nav_pro_offset_top) {
                    $('#menu').css({
                        'position': 'fixed',
                        'top': '60px',
                        'background': 'rgba(255,255,255,0.9)',
                        'width': '100%',
                        height: '52px',
                        border: '1px solid #e8e8e8',
                        padding: '5px',
                        'z-index': '9',
                        overflow: 'hidden'
                    });
                } else {
                    $('#menu').css({
                        'position': '',
                        'top': '',
                        'background': '',
                        'width': '',
                        height: '',
                        border: '',
                        padding: '',
                        'z-index': '',
                        overflow: ''
                    });
                }
            };

            $(window).scroll(function () {
                nav_pro();
            });
});
